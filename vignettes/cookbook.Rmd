---
title: "Data visualization cookbook for the Center for Rural Innovation"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Data visualization cookbook for the Center for Rural Innovation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 8.75,
  fig.height = 8
)
```

## Installing Montserrat

```{r}
library(sysfonts)
library(showtext)

# Loads Montserrat from the google font repository and adds it to sysfonts
sysfonts::font_add_google("Montserrat")
# Ensures that any newly opened graphics devices will use showtext to draw text
showtext_auto()
```

## How to create graphs using CORI themes

```{r, message = FALSE, warning = FALSE}
library(cori.charts)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
```

### Grouped Bar Chart
```{r}
data(cori_poverty)

cori_poverty %>%
  mutate(
    percent_below_poverty_2014 = estimate_below_poverty_level_2014 / estimate_pop_2014,
    percent_below_poverty_2019 = estimate_below_poverty_level_2019 / estimate_pop_2019
  ) %>%
  pivot_longer(
    contains("percent"),
    names_to = "year",
    values_to = "percent_below_poverty"
  ) %>%
  mutate(
    year = str_remove(year, "percent_below_poverty_"),
    rin_community = reorder(rin_community, percent_below_poverty)
  ) %>%
  ggplot(aes(percent_below_poverty, rin_community, fill = year)) +
  geom_col(position = "dodge") +
  scale_fill_cori(reverse = TRUE) +
  scale_x_continuous(
    labels = NULL,
    expand = expansion(mult = c(.005, .1))
  ) +
  labs(
    title = "Share of population below poverty level",
    subtitle = "For select CORI communities",
    x = NULL,
    y = NULL,
    caption = "Source: U.S. Census Bureau"
  ) +
  theme_cori_horizontal_bars()

```

